{"openapi":"3.0.0","paths":{"/api/v1":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":"Service is healthy"}},"summary":"Health check endpoint","tags":["health"]}},"/api/v1/health":{"get":{"operationId":"AppController_healthCheck","parameters":[],"responses":{"200":{"description":"Service is healthy"}},"summary":"Health check for monitoring","tags":["health"]}},"/api/v1/auth/login":{"post":{"description":"Logs in a user by name. Creates a new user with unique ID if needed. No uniqueness check - multiple users can have the same name. Sets JWT tokens in cookies.","operationId":"AuthController_login","parameters":[],"requestBody":{"required":true,"description":"User name for login","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":"Login successful. Returns userId and name. JWT tokens are set in HTTP-only cookies.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseDto"}}}},"400":{"description":"Invalid input data (name is required)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Login failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"summary":"Login by name","tags":["auth"]}},"/api/v1/auth/refresh":{"post":{"description":"Generates a new access token using a valid refresh token. Refresh token is read from HTTP-only cookie (refresh_token). If cookie is not available, token can be provided in request body (for testing only).","operationId":"AuthController_refreshToken","parameters":[],"requestBody":{"required":false,"description":"Refresh token (optional - token is read from cookie by default)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenDto"}}}},"responses":{"200":{"description":"Access token refreshed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}},"400":{"description":"Refresh token is required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Invalid or expired refresh token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"summary":"Refresh access token","tags":["auth"]}},"/api/v1/auth/logout":{"post":{"description":"Revokes the current refresh token and clears authentication cookies.","operationId":"AuthController_logout","parameters":[],"responses":{"200":{"description":"Logged out successfully"},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]}],"summary":"Logout user","tags":["auth"]}},"/api/v1/users":{"post":{"description":"Creates a new user in PostgreSQL and sets JWT token in cookie. If userId is not provided, a new UUID will be generated.","operationId":"UsersController_createUser","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateRedisUserDto"}}}},"responses":{"201":{"description":"User successfully created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RedisUserResponseDto"}}}},"400":{"description":"Invalid input data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"409":{"description":"User with the provided userId or name already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"summary":"Create a new user","tags":["users"]}},"/api/v1/users/profile":{"get":{"description":"Retrieves the profile of the authenticated user (userId from JWT token) with their rooms. Requires authentication.","operationId":"UsersController_getProfile","parameters":[],"responses":{"200":{"description":"User profile with rooms","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfileResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"403":{"description":"Access denied. Invalid token or user not found.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Get current user profile","tags":["users"]}},"/api/v1/users/{userId}":{"get":{"description":"Retrieves a user by their userId (UUID). Requires authentication. Only admins can view other users' data.","operationId":"UsersController_getUser","parameters":[{"name":"userId","required":true,"in":"path","description":"User ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"User found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RedisUserResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"403":{"description":"Access denied. Only admins can view other users' data. Use /users/profile for your own profile.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Get user by ID (admin only)","tags":["users"]},"delete":{"description":"Deletes a user by their userId (UUID). Requires authentication. Users can only delete themselves unless they are admin.","operationId":"UsersController_deleteUser","parameters":[{"name":"userId","required":true,"in":"path","description":"User ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"204":{"description":"User successfully deleted"},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Delete user","tags":["users"]}},"/api/v1/users/{userId}/name":{"patch":{"description":"Updates the name of an existing user. Requires authentication. Users can only update their own name unless they are admin.","operationId":"UsersController_updateName","parameters":[{"name":"userId","required":true,"in":"path","description":"User ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"New user name","example":"Jane Doe","minLength":1,"maxLength":100}},"required":["name"]}}}},"responses":{"200":{"description":"User name updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RedisUserResponseDto"}}}},"400":{"description":"Invalid input data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"409":{"description":"User with the provided name already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Update user name","tags":["users"]}},"/api/v1/rooms":{"post":{"description":"Creates a new room with a unique 6-digit public code and broadcasts the event via WebSocket. Requires authentication.","operationId":"RoomsController_createRoom","parameters":[],"requestBody":{"required":false,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateRoomDto"}}}},"responses":{"201":{"description":"Room successfully created","content":{"application/json":{"schema":{"type":"object","properties":{"roomId":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"publicCode":{"type":"string","example":"123456","description":"6-digit public code for joining the room"}}}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Create a new room","tags":["rooms"]}},"/api/v1/rooms/my-rooms":{"get":{"description":"Retrieves all rooms where the current user is a member. Requires authentication.","operationId":"RoomsController_getMyRooms","parameters":[],"responses":{"200":{"description":"List of user rooms","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RoomResponseDto"}}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Get current user rooms","tags":["rooms"]}},"/api/v1/rooms/{id}":{"get":{"description":"Retrieves room data by room ID. Requires authentication.","operationId":"RoomsController_getRoom","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Room found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Get room by ID","tags":["rooms"]}},"/api/v1/rooms/join":{"post":{"description":"Adds a user to a room using 6-digit public code and broadcasts the update via WebSocket. Requires authentication.","operationId":"RoomsController_joinRoom","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JoinRoomDto"}}}},"responses":{"200":{"description":"User successfully joined the room","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponseDto"}}}},"400":{"description":"Invalid input data (public code must be exactly 6 digits)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found. Please check the room code.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Join a room by public code","tags":["rooms"]}},"/api/v1/rooms/{id}/leave":{"post":{"description":"Removes a user from a room and broadcasts the update via WebSocket. Requires authentication.","operationId":"RoomsController_leaveRoom","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"userId":{"type":"string","description":"User ID (UUID)","example":"123e4567-e89b-12d3-a456-426614174000"}},"required":["userId"]}}}},"responses":{"200":{"description":"User successfully left the room","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponseDto"}}}},"404":{"description":"Room not found"}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Leave a room","tags":["rooms"]}},"/api/v1/rooms/{id}/choice":{"post":{"description":"Records a user's movie choice and broadcasts the update via WebSocket. Requires authentication.","operationId":"RoomsController_chooseMovie","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"userId":{"type":"string","description":"User ID (UUID)","example":"123e4567-e89b-12d3-a456-426614174000"},"movieId":{"type":"string","description":"Movie ID","example":"movie-123"}},"required":["userId","movieId"]}}}},"responses":{"200":{"description":"Movie choice recorded","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponseDto"}}}},"400":{"description":"Invalid input data or user not in room","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Choose a movie","tags":["rooms"]}},"/api/v1/rooms/{id}/members":{"get":{"description":"Retrieves list of room members with their roles and names. Only room members can view this list. Requires authentication.","operationId":"RoomsController_getRoomMembers","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Room members list retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomMembersResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"403":{"description":"You must be a member of the room to view its members","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Get room members","tags":["rooms"]}},"/api/v1/rooms/{id}/members/{userId}":{"delete":{"description":"Removes a user from the room. Only the room creator can remove users. Requires authentication.","operationId":"RoomsController_removeUserFromRoom","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"userId","required":true,"in":"path","description":"User ID to remove (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"User successfully removed from room","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponseDto"}}}},"400":{"description":"Cannot remove the room creator","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"403":{"description":"Only the room creator can remove users","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found or user is not a member","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Remove user from room","tags":["rooms"]}},"/api/v1/rooms/{id}/chat/history":{"get":{"description":"Retrieves chat history for a room. Note: Chat history is automatically sent via WebSocket when joining a room. This HTTP endpoint is provided for reference. Requires authentication and room membership.","operationId":"RoomsController_getChatHistory","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"Chat history retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"roomId":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"messages":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"msg-id"},"roomId":{"type":"string","example":"room-id"},"userId":{"type":"string","example":"user-id"},"userName":{"type":"string","example":"John Doe"},"message":{"type":"string","example":"Hello!"},"createdAt":{"type":"number","example":1704067200000}}}}}}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"403":{"description":"You must be a member of the room to view chat history","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Get chat history (WebSocket recommended)","tags":["rooms"]}},"/api/v1/rooms/{id}/members/{userId}/mute":{"post":{"description":"Mutes a user in the room chat for specified duration (1, 5, or 10 minutes). Only the room creator can mute users. Requires authentication.","operationId":"RoomsController_muteUser","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"userId","required":true,"in":"path","description":"User ID to mute (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"durationMinutes":{"type":"number","enum":[1,5,10],"example":5,"description":"Mute duration in minutes"}},"required":["durationMinutes"]}}}},"responses":{"200":{"description":"User successfully muted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponseDto"}}}},"400":{"description":"Invalid mute duration or cannot mute creator","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"403":{"description":"Only the room creator can mute users","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found or user is not a member","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Mute a user in room chat","tags":["rooms"]},"delete":{"description":"Removes mute from a user in the room chat. Only the room creator can unmute users. Requires authentication.","operationId":"RoomsController_unmuteUser","parameters":[{"name":"id","required":true,"in":"path","description":"Room ID (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"userId","required":true,"in":"path","description":"User ID to unmute (UUID)","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}}],"responses":{"200":{"description":"User successfully unmuted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponseDto"}}}},"400":{"description":"User is not muted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"401":{"description":"Authentication required. JWT token missing or invalid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"403":{"description":"Only the room creator can unmute users","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"404":{"description":"Room not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseDto"}}}}},"security":[{"access_token":[]},{"JWT-auth":[]}],"summary":"Unmute a user in room chat","tags":["rooms"]}}},"info":{"title":"MM Admin API","description":"API documentation for MM Admin backend. All endpoints use JWT authentication via HTTP-only cookies or Bearer token in Authorization header.\n\n## WebSocket Chat API\n\nChat functionality is available via WebSocket connections. See [WebSocket Chat Documentation](./websocket-chat.md) for details.\n\n### Quick Reference:\n- **Connection:** \n  - Development: `ws://localhost:4000/rooms`\n  - Production with proxy: Use relative URL `/rooms` or `/socket.io/` (Socket.IO will auto-detect protocol)\n  - Production direct: `wss://your-backend-server/rooms` (⚠️ MUST use `wss://` for HTTPS sites)\n- **Important:** \n  - For HTTPS frontends (like `https://dashboard.moviematch.space`), you MUST use `wss://` protocol, not `ws://`\n  - If using proxy (Next.js rewrites), use relative URL: `/rooms` or let Socket.IO auto-detect\n  - Socket.IO client will automatically use `wss://` if page is loaded over HTTPS\n- **Authentication:** JWT token in cookie or Authorization header\n- **Events:**\n  - `sendMessage` - Send a chat message\n  - `chatHistory` - Receive chat history (auto-sent on room join)\n  - `newMessage` - Receive new messages from other users\n  - `error` - Error notifications\n\n### Chat Message Format:\n```json\n{\n  \"roomId\": \"uuid\",\n  \"message\": \"Your message text (1-1000 characters)\"\n}\n```\n\n### Requirements:\n- User must be authenticated\n- User must be a member of the room\n- Messages are limited to 1000 characters\n- Chat history is automatically sent when joining a room (up to 100 messages)\n","version":"1.0","contact":{"name":"API Support","url":"","email":""},"license":{"name":"UNLICENSED","url":""}},"tags":[{"name":"users","description":"User management endpoints"},{"name":"rooms","description":"Room management endpoints"},{"name":"auth","description":"Authentication endpoints (login, refresh, logout)"}],"servers":[{"url":"http://localhost:3000","description":"Development server"},{"url":"https://mm-admin-1.onrender.com","description":"Production server"}],"components":{"securitySchemes":{"JWT-auth":{"scheme":"bearer","bearerFormat":"JWT","type":"http","name":"JWT","description":"Enter JWT token","in":"header"},"cookie":{"type":"apiKey","in":"cookie","name":"refresh_token"}},"schemas":{"LoginDto":{"type":"object","properties":{"name":{"type":"string","description":"User name for login","example":"John Doe","minLength":1}},"required":["name"]},"LoginResponseDto":{"type":"object","properties":{"userId":{"type":"string","description":"User ID generated by server (UUID)","example":"123e4567-e89b-12d3-a456-426614174000"},"name":{"type":"string","description":"User name","example":"John Doe"}},"required":["userId","name"]},"ErrorResponseDto":{"type":"object","properties":{"statusCode":{"type":"number","description":"HTTP status code","example":400},"message":{"description":"Error message or array of error messages","example":"Invalid room code. Code must be exactly 6 digits.","oneOf":[{"type":"string"},{"type":"array","items":{"type":"string"}}]},"error":{"type":"string","description":"Error type name","example":"Bad Request"},"timestamp":{"type":"string","description":"ISO timestamp when error occurred","example":"2024-01-15T10:30:00.000Z"},"path":{"type":"string","description":"Request path","example":"/rooms/join"},"method":{"type":"string","description":"HTTP method","example":"POST"}},"required":["statusCode","message","error","timestamp","path","method"]},"RefreshTokenDto":{"type":"object","properties":{"refreshToken":{"type":"string","description":"Refresh token (optional if provided in cookie)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}},"AuthResponseDto":{"type":"object","properties":{}},"CreateRedisUserDto":{"type":"object","properties":{"name":{"type":"string","description":"User name","example":"John Doe","minLength":1,"maxLength":100},"userId":{"type":"string","description":"User ID (UUID). If not provided, a new UUID will be generated","example":"123e4567-e89b-12d3-a456-426614174000","pattern":"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"}}},"RedisUserResponseDto":{"type":"object","properties":{"userId":{"type":"string","description":"Unique user identifier (UUID)","example":"123e4567-e89b-12d3-a456-426614174000"},"name":{"type":"string","description":"User name","example":"John Doe"},"lastActive":{"type":"number","description":"Last active timestamp (Unix timestamp in milliseconds)","example":1704067200000},"role":{"type":"string","description":"User role","enum":["user","admin"],"example":"user"},"recentRooms":{"description":"Array of recently visited room IDs (max 10)","example":["123e4567-e89b-12d3-a456-426614174000","123e4567-e89b-12d3-a456-426614174001"],"type":"array","items":{"type":"string"}}},"required":["userId","name","lastActive","role"]},"RoomResponseDto":{"type":"object","properties":{"roomId":{"type":"string","description":"Room ID (UUID)","example":"123e4567-e89b-12d3-a456-426614174000"},"publicCode":{"type":"string","description":"Public room code (6 digits)","example":"123456"},"createdBy":{"type":"object","description":"User ID of the room creator (UUID)","example":"123e4567-e89b-12d3-a456-426614174000","nullable":true},"users":{"description":"List of user IDs in the room","example":["user1","user2"],"type":"array","items":{"type":"string"}},"userRoles":{"type":"object","description":"User roles in the room (userId -> role)","additionalProperties":{"type":"string","enum":["room_creator","room_member"]},"example":{"user1":"room_creator","user2":"room_member"}},"choices":{"type":"object","description":"User choices (userId -> movieId)","additionalProperties":{"type":"string"},"example":{"user1":"movie-123","user2":"movie-456"}},"isMember":{"type":"boolean","description":"Is current user a member of this room","example":true},"isCreator":{"type":"boolean","description":"Is current user the creator of this room","example":false},"canManage":{"type":"boolean","description":"Can current user manage the room (creator or admin). Use this field to determine if user can delete the room.","example":false},"currentUserRole":{"type":"string","description":"Current user's role in the room","enum":["room_creator","room_member"],"example":"room_member"},"isMuted":{"type":"boolean","description":"Is current user muted in this room","example":false},"muteExpiresAt":{"type":"number","description":"When mute expires (timestamp in milliseconds)","example":1704067800000},"createdAt":{"type":"number","description":"Room creation timestamp","example":1704067200000},"updatedAt":{"type":"number","description":"Room last update timestamp","example":1704067200000}},"required":["roomId","publicCode","users","userRoles","choices"]},"UserProfileResponseDto":{"type":"object","properties":{"userId":{"type":"string","description":"User ID (UUID)","example":"123e4567-e89b-12d3-a456-426614174000"},"name":{"type":"string","description":"User name","example":"John Doe"},"role":{"type":"string","description":"User role","enum":["user","admin"],"example":"user"},"lastActive":{"type":"number","description":"Last active timestamp (milliseconds)","example":1704067200000},"recentRooms":{"description":"List of recent room IDs","example":["room-1","room-2"],"type":"array","items":{"type":"string"}},"rooms":{"description":"List of rooms where user is a member","type":"array","items":{"$ref":"#/components/schemas/RoomResponseDto"}}},"required":["userId","name","rooms"]},"CreateRoomDto":{"type":"object","properties":{"name":{"type":"string","description":"Optional room name","example":"Movie Night"}}},"JoinRoomDto":{"type":"object","properties":{"publicCode":{"type":"string","description":"Public room code (6 digits)","example":"123456","pattern":"^\\d{6}$"},"userId":{"type":"string","description":"User ID (UUID)","example":"123e4567-e89b-12d3-a456-426614174000"}},"required":["publicCode","userId"]},"RoomMembersResponseDto":{"type":"object","properties":{"members":{"type":"array","description":"List of room members with their roles and names","items":{"type":"object","properties":{"userId":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"role":{"type":"string","enum":["room_creator","room_member"],"example":"room_member"},"name":{"type":"string","example":"John Doe"}}},"example":[{"userId":"123e4567-e89b-12d3-a456-426614174000","role":"room_creator","name":"John Doe"},{"userId":"123e4567-e89b-12d3-a456-426614174001","role":"room_member","name":"Jane Smith"}]}},"required":["members"]}}}}